<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.7cb0c1d9a8ffab069d45.css">body,html{margin:0;padding:0}</style><meta name="generator" content="Gatsby 2.3.16"/><title data-react-helmet="true"></title><link rel="shortcut icon" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=008654519ce705ac7bc44303a9014606"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/quattrocentosans/v11/va9Z4lja2NVIDdIAAoMR5MfuElaRB0RyklrRPXw.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/quattrocentosans/v11/va9c4lja2NVIDdIAAoMR5MfuElaRB0zJt08.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/worksans/v4/QGYpz_wNahGAdqQ43Rh3o4T8mNhN.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/google-fonts/s/worksans/v4/QGYsz_wNahGAdqQ43Rh_fKDp.woff2"/><style type="text/css">@font-face{font-family:'Quattrocento Sans';font-style:normal;font-weight:400;src:local('Quattrocento Sans'),local('QuattrocentoSans'),url(/google-fonts/s/quattrocentosans/v11/va9c4lja2NVIDdIAAoMR5MfuElaRB0zJt08.woff2) format('woff2'),url(/google-fonts/s/quattrocentosans/v11/va9c4lja2NVIDdIAAoMR5MfuElaRB0zJt0k.woff) format('woff');font-display: swap;}@font-face{font-family:'Quattrocento Sans';font-style:normal;font-weight:700;src:local('Quattrocento Sans Bold'),local('QuattrocentoSans-Bold'),url(/google-fonts/s/quattrocentosans/v11/va9Z4lja2NVIDdIAAoMR5MfuElaRB0RyklrRPXw.woff2) format('woff2'),url(/google-fonts/s/quattrocentosans/v11/va9Z4lja2NVIDdIAAoMR5MfuElaRB0RyklrRPXo.woff) format('woff');font-display: swap;}@font-face{font-family:'Work Sans';font-style:normal;font-weight:400;src:local('Work Sans'),local('WorkSans-Regular'),url(/google-fonts/s/worksans/v4/QGYsz_wNahGAdqQ43Rh_fKDp.woff2) format('woff2'),url(/google-fonts/s/worksans/v4/QGYsz_wNahGAdqQ43Rh_fKDv.woff) format('woff');font-display: swap;}@font-face{font-family:'Work Sans';font-style:normal;font-weight:600;src:local('Work Sans SemiBold'),local('WorkSans-SemiBold'),url(/google-fonts/s/worksans/v4/QGYpz_wNahGAdqQ43Rh3o4T8mNhN.woff2) format('woff2'),url(/google-fonts/s/worksans/v4/QGYpz_wNahGAdqQ43Rh3o4T8mNhL.woff) format('woff');font-display: swap;}</style><link as="script" rel="preload" href="/webpack-runtime-9d453257ef94d98a14d1.js"/><link as="script" rel="preload" href="/styles-6a687b28ef64147eacaf.js"/><link as="script" rel="preload" href="/app-8e543e269a5adf9db6db.js"/><link as="script" rel="preload" href="/9-04dc77a0bc440047661d.js"/><link as="script" rel="preload" href="/component---src-templates-article-tsx-a5cb4169c55b4951fc5f.js"/><link as="fetch" rel="preload" href="/static/d/85/path---article-5-cc-608-b-9460-d-3900642-eee-3-b-d-2-f-c9d-S8aHDz8ODWL9465VYOMYCsoxIs.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><style data-emotion-css="k8ewma">.css-k8ewma{margin:0 auto;padding:0 32px;max-width:960px;box-sizing:border-box;}.css-k8ewma,.css-k8ewma input{font-family:"Quattrocento Sans",sans-serif;}.css-k8ewma h1,.css-k8ewma h2,.css-k8ewma h3,.css-k8ewma h4,.css-k8ewma h5,.css-k8ewma h6{font-family:"Work Sans",sans-serif;}.css-k8ewma h2{font-size:28px;font-weight:600;}.css-k8ewma a{color:#1d9c81;-webkit-text-decoration:none;text-decoration:none;}.css-k8ewma a:hover{-webkit-text-decoration:underline;text-decoration:underline;}.css-k8ewma p,.css-k8ewma ol{font-size:20px;line-height:28px;color:hsla(0,0%,0%,0.8);}.css-k8ewma ol{padding:0;margin-left:28px;margin-bottom:28px;margin-top:0;}.css-k8ewma ol li{margin-bottom:14px;}.css-k8ewma blockquote{font-style:italic;color:hsla(0,0%,0%,0.65);border-left:2px solid #1d9c81;margin:0;padding-left:20px;}</style><div class="css-k8ewma e9jw82o0"><style data-emotion-css="18hyp7h">.css-18hyp7h{height:80px;}.css-18hyp7h:after{content:"";display:block;position:relative;width:25%;border-bottom:1px solid #52a2d2;}</style><header class="css-18hyp7h e1qr1m9j0"><div style="height:100%;display:flex;justify-content:space-between"><style data-emotion-css="70qvj9">.css-70qvj9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><a class="css-70qvj9" href="/"><style data-emotion-css="vekl12 animation-marozl animation-marozl animation-marozl animation-138kxdd">.css-vekl12{display:block;width:62px;height:38px;}.css-vekl12 path{stroke:#52a2d2;stroke-dashoffset:0;stroke-dasharray:0;stroke-width:2;fill:none;}.css-vekl12 polygon{stroke:#52a2d2;stroke-width:2;fill:none;}.css-vekl12 polygon:nth-of-type(2){-webkit-transform:translateX(17px);-ms-transform:translateX(17px);transform:translateX(17px);}.css-vekl12 polygon:nth-of-type(3){-webkit-transform:translateX(34px);-ms-transform:translateX(34px);transform:translateX(34px);}.css-vekl12:hover path{stroke-dashoffset:200;stroke-dasharray:200;-webkit-animation:animation-138kxdd 1s linear forwards;animation:animation-138kxdd 1s linear forwards;}.css-vekl12:hover polygon:nth-of-type(1){-webkit-animation:animation-marozl 0.7s ease-in-out 0.2s forwards;animation:animation-marozl 0.7s ease-in-out 0.2s forwards;}.css-vekl12:hover polygon:nth-of-type(2){-webkit-animation:animation-marozl 0.7s ease-in-out 0.1s forwards;animation:animation-marozl 0.7s ease-in-out 0.1s forwards;}.css-vekl12:hover polygon:nth-of-type(3){-webkit-animation:animation-marozl 0.7s ease-in-out forwards;animation:animation-marozl 0.7s ease-in-out forwards;}@-webkit-keyframes animation-marozl{from{opacity:1;}50%{opacity:0;},to{opacity:1;}}@keyframes animation-marozl{from{opacity:1;}50%{opacity:0;},to{opacity:1;}}@-webkit-keyframes animation-marozl{from{opacity:1;}50%{opacity:0;},to{opacity:1;}}@keyframes animation-marozl{from{opacity:1;}50%{opacity:0;},to{opacity:1;}}@-webkit-keyframes animation-marozl{from{opacity:1;}50%{opacity:0;},to{opacity:1;}}@keyframes animation-marozl{from{opacity:1;}50%{opacity:0;},to{opacity:1;}}@-webkit-keyframes animation-138kxdd{to{stroke-dashoffset:0;}}@keyframes animation-138kxdd{to{stroke-dashoffset:0;}}</style><svg viewBox="-2 0 63 38" class="css-vekl12 e1qr1m9j1"><g><polygon points="18.1049237 0.949864143 0.589500559 18.4652872 18.565474 36.4412607 20.8097747 34.19696 5.21794576 18.4652872 20.3757781 3.30745486"></polygon><polygon points="18.1049237 0.949864143 0.589500559 18.4652872 18.565474 36.4412607 20.8097747 34.19696 5.21794576 18.4652872 20.3757781 3.30745486"></polygon><polygon points="18.1049237 0.949864143 0.589500559 18.4652872 18.565474 36.4412607 20.8097747 34.19696 5.21794576 18.4652872 20.3757781 3.30745486"></polygon></g></svg></a></div></header><style data-emotion-css="jm2nyr">.css-jm2nyr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin-top:24px;margin-bottom:8px;}.css-jm2nyr h2{margin-top:0;margin-bottom:0;}.css-jm2nyr .categories{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}.css-jm2nyr .categories .category{font-size:16px;background-color:#52a2d2;color:white;padding:2px 12px;border-radius:12px;cursor:pointer;white-space:nowrap;}.css-jm2nyr .categories .category:not(:first-of-type){margin-left:10px;}</style><div class="css-jm2nyr e1qlhw9a0"><h2><a aria-current="page" class="" href="/Article_5cc608b9460d3900642eee3b">The Diffie-Hellman Protocol</a></h2><div class="categories"><span class="category">cryptography</span><span class="category">public-key cryptography</span></div></div><style data-emotion-css="1duhggz">.css-1duhggz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}.css-1duhggz .fullname-date{color:#1d9c81;}.css-1duhggz .fullname-date a{margin-right:16px;}.css-1duhggz .languages{color:#52a2d2;}</style><div class="css-1duhggz e1qlhw9a1"><div class="fullname-date"><a href="/authors/5cc6061d73da54ffd832d797">Denis Shtabnoy</a><span>April 27th, 2019</span></div><div class="languages">{ <!-- -->en<!-- --> }</div></div><style data-emotion-css="1a75f6r">.css-1a75f6r p:first-child::first-letter{color:#1d9c81;font-size:45px;line-height:53px;float:left;padding-right:0.5rem;font-family:serif;}.css-1a75f6r p > img{margin-left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);}</style><div class="css-1a75f6r"><p>This problem was one of the most important problems of the XX century. Before it was solved, people had to convey keys on a sheet of paper as during the Second World War. In 1976 breakthrough happened when an American cryptographer Whitfield Diffie together with his colleague, professor of Stanford University, Martin Hellman published key exchange scheme which later became known as <strong>the Diffie-Hellman protocol</strong>. Actually, neither Alice nor Bob doesn&#x27;t transmit a secret key at all, but the key is generated on both sides just by the simple mathematical trick. This absolutely brilliant and simple solution made a real revolution in the world of encryption and launched a whole direction in cryptography called asymmetric cryptography (or public-key cryptography). So how can Alice and Bob get the same keys without passing them to each other?</p><p>This expression is also valid for modular arithmetic which is the base for all cryptography schemes today. So you have to be familiar enough with this branch of math to understand how most of the ciphers work.</p><p>To get the same key on both sides:</p><ol start="1"><li>Alice &amp; Bob choose modulo <strong>m</strong> and exponent base <strong>g</strong>. This data is <em>public</em>, i.e. open to everyone and it won&#x27;t compromise the key.</li><li>Alice takes a random giant number <strong>a</strong> and doesn&#x27;t show it to anyone. This is her <em>secret</em> key but not the one which will be used to sign messages.</li><li>Alice calculates <!-- --> (see <a href="https://en.wikipedia.org/wiki/Modular_arithmetic">modular arithmetics</a>) and sends this number to Bob. She can reveal <strong>A</strong> to any person (it&#x27;s a kind of public key).</li></ol><p>Knowing the numbers <strong>a</strong>, <strong>g</strong> and <strong>m</strong>, it is easy for the computer to calculate <strong>A</strong> (for example, by the algorithm of <a href="https://math.stackexchange.com/questions/2204627/repeated-squaring-techniques">Repeated squaring</a>). But knowing <strong>A</strong>, <strong>g</strong>, and <strong>m</strong>, it is almost impossible (in a reasonable time), even for the fastest computer in the world, to calculate <strong>a</strong>. But in order for this to become impossible, it is necessary to select sufficiently large numbers (more than 100 characters). Otherwise, the computer can quickly look through all possible choices and crack the secret number.</p><p>It is known from school math that the inverse function for exponentiation is the logarithm. It seems not so difficult to calculate the logarithm <!-- -->, right? After all, even calculators can take logarithms of sufficiently large numbers. Not a hundred digits, of course, but computers are million times faster. he problem lies in the fact that the set of real numbers is continuous, and the logarithms are considered with a certain degree of approximation. However, in modular arithmetic, we use integers, which makes it impossible to approximate the calculation of the logarithm. This problem is called the <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">discrete logarithm problem</a>.</p><blockquote><p>By the way, every asymmetric cryptography method uses functions that are easily computed in one direction and extremely difficult to compute in reverse (see <a href="https://en.wikipedia.org/wiki/Trapdoor_function">Trapdoor functions or One-way functions with a hidden path</a>). For example, <strong>the RSA algorithm</strong> uses the multiplication of two prime numbers, which is very easy to do, but the reverse operation - factorization - is extremely difficult to execute. And <strong>the Diffie-Hellman algorithm</strong>, as we saw previously, uses exponentiation in one direction (easy) and logarithms in the opposite direction (hard). A third well-known example is <a href="http://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gent-introduction">elliptical curves</a>, which are actively used in modern protocols.</p></blockquote><ol start="4"><li>Bob, just like Alice did, takes a random giant number <strong>b</strong> and doesn&#x27;t show it to anyone. This is his <em>secret</em> key but not the one which will be used to sign messages.</li><li>Again, as Alice did, Bob calculates <!-- --> and sends this number to Alice (it&#x27;s his <em>public</em> key).</li><li>Having obtained the number <strong>A</strong> from Alice, Bob calculates <!-- -->.</li><li>Having obtained the number <strong>B</strong> from Bob, Alice calculates <!-- -->.</li><li>Using the property of exponentiation mentioned at the beginning of the article, we obtain</li></ol><p>Voila! The magic of mathematics has done its work, and now both sides have the secret key s (without passing any secret information), which can encrypt further correspondence.</p><p><img alt="Diffie-Hellman scheme" src="https://res.cloudinary.com/shtabnoy/image/upload/v1556627061/mad97sn2sezsd8nbytmj.svg"/></p><p>To consolidate all the previously written, we can go through all the steps using small numbers that are convenient for counting. In real systems this never happens, because extremely large numbers and very carefully selected inputs <strong>m</strong> and <strong>g</strong> are used since there are already ways to quickly find a and b from public data for certain <strong>m</strong> and <strong>g</strong>. For convenience, we will merge several steps into one.</p><ol start="1"><li>Let <strong>m</strong> = 11, <strong>g</strong> = 2, <strong>a</strong> = 5, <strong>b</strong> = 3</li><li></li><li></li><li> (the secret key)</li></ol><p>This was a simple and elegant way to produce a common secret key that came to Diffie and Hellman bright minds when they were working on the concept of public-key cryptography in Stanford offices in the distant year of 1976.</p></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-article-tsx","jsonName":"article-5-cc-608-b-9460-d-3900642-eee-3-b-d2f","path":"/Article_5cc608b9460d3900642eee3b"};window.dataPath="85/path---article-5-cc-608-b-9460-d-3900642-eee-3-b-d-2-f-c9d-S8aHDz8ODWL9465VYOMYCsoxIs";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-8e543e269a5adf9db6db.js"],"component---src-templates-article-tsx":["/component---src-templates-article-tsx-a5cb4169c55b4951fc5f.js"],"component---src-templates-author-tsx":["/component---src-templates-author-tsx-d2794bbeda6f62d53c73.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-eadd81c525ea77f3f597.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-e1f0011d274126e73f23.js"],"pages-manifest":["/pages-manifest-c07899516f2e19fc4316.js"]};/*]]>*/</script><script src="/component---src-templates-article-tsx-a5cb4169c55b4951fc5f.js" async=""></script><script src="/9-04dc77a0bc440047661d.js" async=""></script><script src="/app-8e543e269a5adf9db6db.js" async=""></script><script src="/styles-6a687b28ef64147eacaf.js" async=""></script><script src="/webpack-runtime-9d453257ef94d98a14d1.js" async=""></script></body></html>